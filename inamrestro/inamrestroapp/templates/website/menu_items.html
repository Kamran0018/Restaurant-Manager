{% extends 'layout.html' %}
{% block content %}

<div class="mb-8">
    {% if category %}
    <div class="flex items-center gap-3 mb-3">
        <a href="{% url 'home' %}" class="text-orange-600 hover:underline">← Back to Categories</a>
    </div>
    <h1 class="text-3xl sm:text-4xl font-bold mb-2">{{ category.name }}</h1>
    {% if category.description %}
    <p class="text-gray-600 text-lg">{{ category.description }}</p>
    {% endif %}
    {% else %}
    <h1 class="text-3xl sm:text-4xl font-bold mb-2">Menu Items</h1>
    {% endif %}
</div>

<!-- Messages -->
{% if messages %}
<div class="mb-6 space-y-2">
    {% for message in messages %}
    <div class="{% if message.tags == 'error' %}bg-red-100 text-red-700{% elif message.tags == 'warning' %}bg-yellow-100 text-yellow-700{% else %}bg-green-100 text-green-700{% endif %} p-4 rounded-lg">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

{% if items %}
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for item in items %}
    <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md hover:shadow-xl transition-all duration-300 flex flex-col group">
        {% if item.image %}
        <div class="overflow-hidden rounded-lg mb-4">
            <img src="{{ item.image.url }}" alt="{{ item.name }}"
                 class="w-full h-48 sm:h-52 object-cover group-hover:scale-105 transition-transform duration-300">
        </div>
        {% endif %}

        <h2 class="text-xl sm:text-2xl font-semibold mb-2">{{ item.name }}</h2>
        <p class="text-gray-600 text-sm sm:text-base mb-4 flex-grow line-clamp-2">{{ item.description }}</p>

        <div class="flex items-center justify-between mt-auto">
            <p class="text-2xl font-bold text-orange-600">₹{{ item.price }}</p>
        </div>

        {% if request.user.is_authenticated %}
        <a href="{% url 'add_to_cart' item.id %}"
           class="block bg-orange-600 text-white text-center py-3 mt-4 rounded-lg font-semibold hover:bg-orange-700 transition-colors active:scale-95">
            Add to Cart
        </a>
        {% else %}
        <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
            <p class="text-sm text-center">
                <a href="{% url 'login' %}?next={{ request.path }}" class="text-orange-600 font-semibold hover:underline">
                    Login
                </a> to add items to cart
            </p>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center py-16 bg-white rounded-xl shadow-md">
    <h2 class="text-2xl font-bold text-gray-700 mb-2">No items available</h2>
    <p class="text-gray-600 mb-6">Check back later for new items!</p>
    <a href="{% url 'home' %}" class="inline-block bg-orange-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-orange-700 transition-colors">
        Browse Categories
    </a>
</div>
{% endif %}

{% endblock %}
